"Content"
"    option explicit&#xD;&#xA;    &#xD;&#xA;    Const vbext_ct_ClassModule = 2&#xD;&#xA;    Const vbext_ct_Document = 100&#xD;&#xA;    Const vbext_ct_MSForm = 3&#xD;&#xA;    Const vbext_ct_StdModule = 1&#xD;&#xA;    &#xD;&#xA;    Main&#xD;&#xA;    &#xD;&#xA;    Sub Main&#xD;&#xA;        Dim xl&#xD;&#xA;        Dim fs&#xD;&#xA;        Dim WBook&#xD;&#xA;        Dim VBComp&#xD;&#xA;        Dim Sfx&#xD;&#xA;        Dim ExportFolder&#xD;&#xA;    &#xD;&#xA;        If Wscript.Arguments.Count <> 1 Then&#xD;&#xA;            MsgBox """"As the only argument, give the FULL path to an XLS file to extract all the VBA from it.""""&#xD;&#xA;        Else&#xD;&#xA;    &#xD;&#xA;            Set xl = CreateObject(""""Excel.Application"""")&#xD;&#xA;            Set fs = CreateObject(""""Scripting.FileSystemObject"""")&#xD;&#xA;    &#xD;&#xA;            xl.Visible = true&#xD;&#xA;    &#xD;&#xA;            Set WBook = xl.Workbooks.Open(Trim(wScript.Arguments(0)))&#xD;&#xA;    &#xD;&#xA;            ExportFolder = WBook.Path & """"\"""" & fs.GetBaseName(WBook.Name)&#xD;&#xA;    &#xD;&#xA;            fs.CreateFolder(ExportFolder)&#xD;&#xA;    &#xD;&#xA;            For Each VBComp In WBook.VBProject.VBComponents&#xD;&#xA;                Select Case VBComp.Type&#xD;&#xA;                    Case vbext_ct_ClassModule, vbext_ct_Document&#xD;&#xA;                        Sfx = """".cls""""&#xD;&#xA;                    Case vbext_ct_MSForm&#xD;&#xA;                        Sfx = """".frm""""&#xD;&#xA;                    Case vbext_ct_StdModule&#xD;&#xA;                        Sfx = """".bas""""&#xD;&#xA;                    Case Else&#xD;&#xA;                        Sfx = """"""""&#xD;&#xA;                End Select&#xD;&#xA;                If Sfx <> """""""" Then&#xD;&#xA;                    On Error Resume Next&#xD;&#xA;                    Err.Clear&#xD;&#xA;                    VBComp.Export ExportFolder & """"\"""" & VBComp.Name & Sfx&#xD;&#xA;                    If Err.Number <> 0 Then&#xD;&#xA;                        MsgBox """"Failed to export """" & ExportFolder & """"\"""" & VBComp.Name & Sfx&#xD;&#xA;                    End If&#xD;&#xA;                    On Error Goto 0&#xD;&#xA;                End If&#xD;&#xA;            Next&#xD;&#xA;    &#xD;&#xA;            xl.Quit&#xD;&#xA;        End If&#xD;&#xA;    End Sub"
